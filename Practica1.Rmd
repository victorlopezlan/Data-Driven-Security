---
title: "Práctica 1"
author: "Oriol, Víctor, Miriam, Ulises"
date: "2025-12-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(warning = F)
knitr::opts_chunk$set(error = F)
knitr::opts_chunk$set(message = F)
```

## **Ejercicio 1**

**De las siguientes preguntas, clasifica cada una como descriptiva, exploratoria, inferencia, predictiva o causal, y razona brevemente (una frase) el porqué:**

**1. Dado un registro de vehículos que circulan por una autopista, disponemos de su marca y modelo, país de matriculación, y tipo de vehículo (por número de ruedas). Con tal de ajustar precios de los peajes, ¿Cuántos vehículos tenemos por tipo? ¿Cuál es el tipo más frecuente? ¿De qué países tenemos más vehículos?**

```         
Descriptiva, ya que estamos buscando estadíticas del total de vehículos según sus características para hacer un ajuste del precio de los peajes.
```

**2. Dado un registro de visualizaciones de un servicio de video-on-demand, donde disponemos de los datos del usuario, de la película seleccionada, fecha de visualización y categoría de la película, queremos saber ¿Hay alguna preferencia en cuanto a género literario según los usuarios y su rango de edad?**

```         
Exploratoria, ya que se está relacionando el rango de edad del usuario con la preferencia del género cinematográfico.
```

**3. Dado un registro de peticiones a un sitio web, vemos que las peticiones que provienen de una red de telefonía concreta acostumbran a ser incorrectas y provocarnos errores de servicio. ¿Podemos determinar si en el futuro, los próximos mensajes de esa red seguirán dando problemas? ¿Hemos notado el mismo efecto en otras redes de telefonía?**

```         
Predictiva, ya que intentamos predecir un comportamiento futuro a partir de un registro de peticiones ya realizadas a un sitio web.
```

**4. Dado los registros de usuarios de un servicio de compras por internet, los usuarios pueden agruparse por preferencias de productos comprados. Queremos saber si ¿Es posible que, dado un usuario al azar y según su historial, pueda ser directamente asignado a un o diversos grupos?**

```         
Predictiva, porque a partir de los datos que tenemos del historial del usuario, le estamos asignando a un o diversos grupos.
```

## **Ejercicio 2**

```{r carrega_llibreires}
library(readr)
library(dplyr)
```



```{r carrega_dades}
epa_http <- read_table("epa-http.csv", col_names = FALSE, show_col_types = F)
colnames(epa_http) <- c("IP", "Timestamp", "Action", "File", "HTTP version", "Response Code", "Bytes")
```


```{r headjj}
head(epa_http)
```

#### **Pregunta 1**

**Número filas:**
```{r numFilas}
nrow(epa_http)
```

**Número columnas:**
```{r numCol}
ncol(epa_http)
```

**Media columna Bytes:**
```{r mediaBytes}
epa_http$Bytes <- as.integer(epa_http$Bytes)
mean(epa_http$Bytes, na.rm = T)
```

#### **Pregunta 2**

```{r sumaEdus}
sum(grepl(".edu", epa_http$IP))

```

#### **Pregunta 3**

```{r limpiarTipo}
epa_http$Action <- sub('^"', '', epa_http$Action)
```

```{r filtrarGET_y_CONTEO}

# Creamos un nuevo dataframe donde solo estan las filas con GET
epa_get <- epa_http[epa_http$Action == "GET", ]
#Vemos cuales son los valores unicos que tine la columa de Action
#unique(epa_get$Action)

#Cogemos en nuevo dataframe y le creamos una nueva columna llamada hora con el valor correspondiente del Timestamp
epa_get <- epa_get %>%
  mutate(
    Hora = sub("^\\[|\\]$", "", Timestamp),  # quita [ ]
    Hora = sapply(strsplit(Hora, ":"), `[`, 2)
  )

#Comprovamos que la obtención de los valores de las horas estan en el rango correcto [0-23]
#unique(epa_get$Hora)

#Hacemos el conteo de cuantas veces aparece cada una de las horas:
# Para ello creamos un df nuevo con solo dos columnas, el valor de las horas [0-23] y el número de veces que aparece cada hora
conteo_horas <- epa_get %>%
  count(Hora)

cat("La hora más comun en las peticiones que ha recibido el servidor es:\n")
#print(conteo_horas)

#conteo_horas[order(conteo_horas$n, decreasing = TRUE), ]

#Mostramos solo la primera fila, ya que estamos filtrando de manera descendente la columna que contiene el número de veces que aparece cada hora
head(conteo_horas[order(conteo_horas$n, decreasing = TRUE), ], 1)

```

#### **Pregunta 4**
```{r Apartado4}

#filtramos solo las filas que contienen la cadena de texto ".edu" en la columna de IP
epa_edu <- epa_http[grepl("\\.edu", epa_http$IP), ]

#filtramos solo las filas que contienen un fichero de descarga .txt
epa_edu <- epa_edu[grepl("\\.txt", epa_edu$File), ]


cat("El número total de Bytes que se han transmitido en las peticiones de descarga de ficheros de texto son:\n")
#Hacemos la suma de la columna de Bytes, ignorando aquellos que tienen valor de NA
sum(epa_edu$Bytes, na.rm = T)

```
```{r headjj2}
#head(epa_http)
#nrow(epa_http)
```

